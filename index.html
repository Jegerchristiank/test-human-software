<!DOCTYPE html>
<html lang="da">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Human Biologi Studio</title>
    <link rel="icon" href="Logo.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&family=Sora:wght@500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="ambient ambient-one"></div>
    <div class="ambient ambient-two"></div>
    <div class="ambient ambient-three"></div>
    <div class="noise-layer"></div>
    <div class="theme-switch" role="group" aria-label="Tema">
      <span class="theme-label">Lys</span>
      <label class="theme-toggle">
        <input type="checkbox" id="theme-toggle" aria-label="Skift til mørk tilstand" />
      </label>
      <span class="theme-label">Mørk</span>
    </div>

    <div class="app">
      <section id="landing-screen" class="screen hidden">
        <div class="landing-shell">
          <header class="landing-header reveal" style="--delay: 0s">
            <div class="brand-block">
              <div class="brand-mark">
                <img class="brand-logo" src="Logo.png" alt="Københavns Universitet logo" />
              </div>
              <div>
                <div class="brand-subtitle">Københavns Universitet · Sundhed &amp; Informatik</div>
                <h1>Human Biologi Studio</h1>
                <p>
                  Spil dig gennem tidligere eksamenssæt. Saml point, jagt 12-tallet og se din udvikling over tid.
                </p>
              </div>
            </div>
            <div class="landing-actions">
              <button id="landing-start-btn" class="btn primary" type="button">Byg runde</button>
            </div>
          </header>

          <div class="landing-grid">
            <section class="panel hero-panel reveal" style="--delay: 0.05s">
              <div class="panel-header">
                <h2>Din mission</h2>
                <p>Hver runde giver XP i form af point og karakter. Sigt mod 12 og hold streaken kørende.</p>
              </div>
              <div class="hero-grid">
                <div class="hero-card primary">
                  <div class="hero-label">Niveau</div>
                  <div class="hero-value" id="hero-rank">Niveau —</div>
                  <div class="hero-meta" id="hero-rank-meta">Ingen rekord endnu</div>
                </div>
                <div class="hero-card">
                  <div class="hero-label">Måltavle</div>
                  <div class="hero-value" id="hero-target">Mål: 12</div>
                  <div class="hero-meta" id="hero-target-meta">92% for topkarakter</div>
                  <div class="hero-progress">
                    <div class="hero-progress-fill" id="hero-progress-fill"></div>
                  </div>
                </div>
                <div class="hero-card">
                  <div class="hero-label">Streak</div>
                  <div class="hero-value" id="hero-streak">0</div>
                  <div class="hero-meta" id="hero-streak-meta">Ingen streak endnu</div>
                </div>
              </div>
            </section>

            <section class="panel history-panel reveal" style="--delay: 0.1s">
              <div class="panel-header">
                <h2>Seneste runder</h2>
                <p>Følg med i hvordan du udvikler dig over tid.</p>
              </div>
              <div class="history-list" id="landing-history-list"></div>
            </section>
          </div>
        </div>
      </section>

      <section id="menu-screen" class="screen active">
        <div class="menu-shell">
          <header class="menu-header reveal" style="--delay: 0s">
            <div class="brand-block">
              <div class="brand-mark">
                <img class="brand-logo" src="Logo.png" alt="Københavns Universitet logo" />
              </div>
              <div>
                <div class="brand-subtitle">Københavns Universitet · Sundhed &amp; Informatik</div>
                <h1>Human Biologi Studio</h1>
                <p>
                  Byg en runde, der passer til din repetition. Filtrer på årgang og emner, miks dine spørgsmål og
                  sæt tempoet selv.
                </p>
              </div>
            </div>
            <div class="menu-right">
              <div class="menu-stats">
                <div class="stat-pill" id="question-count-chip">Indlæser …</div>
                <div class="stat-pill" id="pool-count-chip">0 i puljen</div>
                <div class="stat-pill" id="ai-status-pill">Assistent: Tjekker …</div>
              </div>
            </div>
          </header>

          <div class="menu-grid">
            <div class="menu-column">
              <section class="panel builder reveal" style="--delay: 0.05s">
                <div class="panel-header">
                  <h2>Session builder</h2>
                  <p>Vælg en retning og finjustér længde, mix og flow på ét sted.</p>
                </div>

                <div class="builder-stack">
                  <div class="builder-section">
                    <div class="section-title">
                      <h3>Hvad vil du træne?</h3>
                      <p>Start med en profil, og justér bagefter efter behov.</p>
                    </div>
                    <div class="preset-grid" id="preset-grid">
                      <button class="preset-card" type="button" data-preset="exam" aria-pressed="false">
                        <div class="preset-title">Eksamen</div>
                        <div class="preset-text">Balanceret mix med realistisk tempo.</div>
                        <div class="preset-meta">24 spg · Standard</div>
                      </button>
                      <button class="preset-card" type="button" data-preset="review" aria-pressed="false">
                        <div class="preset-title">Repetition</div>
                        <div class="preset-text">Bred dækning med færre gentagelser.</div>
                        <div class="preset-meta">30 spg · Bredt</div>
                      </button>
                      <button class="preset-card" type="button" data-preset="weak" aria-pressed="false">
                        <div class="preset-title">Svage områder</div>
                        <div class="preset-text">Fokus på fejl + adaptiv prioritet.</div>
                        <div class="preset-meta">20 spg · Fokus</div>
                      </button>
                      <button class="preset-card" type="button" data-preset="tempo" aria-pressed="false">
                        <div class="preset-title">Tempo</div>
                        <div class="preset-text">Hurtig rytme med auto-videre.</div>
                        <div class="preset-meta">18 spg · Tid</div>
                      </button>
                    </div>
                  </div>

                  <div class="builder-section">
                    <div class="section-title">
                      <h3>Din runde</h3>
                      <p>Juster længde og fordeling mellem opgavetyper.</p>
                    </div>
                    <div class="control-row">
                      <label class="control-label" for="question-count">
                        Antal spørgsmål
                        <span
                          class="info"
                          data-tooltip="Vælg hvor mange spørgsmål runden skal have. Hvis puljen er mindre, forkortes runden automatisk."
                          tabindex="0"
                          aria-label="Info om antal spørgsmål"
                          >i</span
                        >
                      </label>
                      <div class="range-control">
                        <input type="range" id="question-count" min="5" max="40" step="1" value="24" />
                        <input type="number" id="question-count-input" min="5" max="40" step="1" value="24" />
                      </div>
                      <div class="control-hint">
                        MCQ-tallet styrer længden; kortsvar følger ratioen. I uendelig mode er tallet batch-størrelse.
                      </div>
                    </div>

                    <div class="toggle-grid compact essentials">
                      <label class="toggle">
                        <input type="checkbox" id="toggle-include-mcq" checked />
                        <span>
                          Inkluder MCQ
                          <span
                            class="info"
                            data-tooltip="Tager multiple choice-spørgsmål med i runden."
                            tabindex="0"
                            aria-label="Info om MCQ"
                            >i</span
                          >
                        </span>
                        <small>Multiple choice</small>
                      </label>
                      <label class="toggle">
                        <input type="checkbox" id="toggle-include-short" checked />
                        <span>
                          Inkluder kortsvar
                          <span
                            class="info"
                            data-tooltip="Tager kortsvarsopgaver med i runden."
                            tabindex="0"
                            aria-label="Info om kortsvar"
                            >i</span
                          >
                        </span>
                        <small>Åbne spørgsmål</small>
                      </label>
                    </div>
                    <details class="more-drawer">
                      <summary>
                        <span>Avanceret</span>
                        <small>Mix, flow og hjælp</small>
                      </summary>
                      <div class="more-body">
                        <div class="control-row">
                          <label class="control-label" for="ratio-mcq">
                            MCQ / kortsvar ratio
                            <span
                              class="info"
                              data-tooltip="Sæt forholdet mellem MCQ og kortsvar. 4:1 giver ca. 24 MCQ og 6 kortsvar."
                              tabindex="0"
                              aria-label="Info om ratio"
                              >i</span
                            >
                          </label>
                          <div class="ratio-control">
                            <input type="number" id="ratio-mcq" min="1" max="12" step="1" value="4" />
                            <span class="ratio-divider">:</span>
                            <input type="number" id="ratio-short" min="1" max="12" step="1" value="1" />
                          </div>
                          <div class="control-hint">MCQ-tallet styrer længden; kortsvar følger ratioen.</div>
                        </div>

                        <details class="settings-drawer">
                          <summary>
                            <span>Indhold &amp; visning</span>
                            <small>Metadata og svarlayout</small>
                          </summary>
                          <div class="settings-body">
                            <div class="toggle-grid compact">
                              <label class="toggle">
                                <input type="checkbox" id="toggle-show-meta" checked />
                                <span>
                                  Vis metadata
                                  <span
                                    class="info"
                                    data-tooltip="Viser år og emne direkte på spørgsmålet."
                                    tabindex="0"
                                    aria-label="Info om metadata"
                                    >i</span
                                  >
                                </span>
                                <small>År + emne på kortet</small>
                              </label>
                              <label class="toggle">
                                <input type="checkbox" id="toggle-shuffle-options" checked />
                                <span>
                                  Shuffle svarmuligheder
                                  <span
                                    class="info"
                                    data-tooltip="Blander indholdet mellem A–D, så bogstaverne altid står i samme rækkefølge."
                                    tabindex="0"
                                    aria-label="Info om shuffle svarmuligheder"
                                    >i</span
                                  >
                                </span>
                                <small>Blander indhold</small>
                              </label>
                            </div>
                          </div>
                        </details>

                        <details class="settings-drawer">
                          <summary>
                            <span>Mix &amp; gentagelser</span>
                            <small>Adaptiv læring og fejl</small>
                          </summary>
                          <div class="settings-body">
                            <div class="toggle-grid compact">
                              <label class="toggle">
                                <input type="checkbox" id="toggle-shuffle-questions" checked />
                                <span>
                                  Shuffle spørgsmål
                                  <span
                                    class="info"
                                    data-tooltip="Blander rækkefølgen af spørgsmålene i runden."
                                    tabindex="0"
                                    aria-label="Info om shuffle spørgsmål"
                                    >i</span
                                  >
                                </span>
                                <small>Nyt mix hver gang</small>
                              </label>
                              <label class="toggle">
                                <input type="checkbox" id="toggle-balanced" checked />
                                <span>
                                  Balancer emner
                                  <span
                                    class="info"
                                    data-tooltip="Fordeler spørgsmålene mere jævnt på tværs af emner i puljen."
                                    tabindex="0"
                                    aria-label="Info om balancer emner"
                                    >i</span
                                  >
                                </span>
                                <small>Fordeler bredt</small>
                              </label>
                              <label class="toggle">
                                <input type="checkbox" id="toggle-adaptive-mix" />
                                <span>
                                  Adaptiv mix
                                  <span
                                    class="info"
                                    data-tooltip="Vægter spørgsmål baseret på fejl, tempo og seneste svar."
                                    tabindex="0"
                                    aria-label="Info om adaptiv mix"
                                    >i</span
                                  >
                                </span>
                                <small>Prioritér svage områder</small>
                              </label>
                              <label class="toggle">
                                <input type="checkbox" id="toggle-avoid-repeats" />
                                <span>
                                  Undgå gentagelser
                                  <span
                                    class="info"
                                    data-tooltip="Skjuler spørgsmål du allerede har set i tidligere runder."
                                    tabindex="0"
                                    aria-label="Info om undgå gentagelser"
                                    >i</span
                                  >
                                </span>
                                <small>Skjuler tidligere spørgsmål</small>
                              </label>
                              <label class="toggle">
                                <input type="checkbox" id="toggle-prefer-unseen" checked />
                                <span>
                                  Prioritér nye spørgsmål
                                  <span
                                    class="info"
                                    data-tooltip="Skubber runden mod spørgsmål du ikke har set før, uden at fjerne dem helt."
                                    tabindex="0"
                                    aria-label="Info om nye spørgsmål"
                                    >i</span
                                  >
                                </span>
                                <small>Færre gentagelser</small>
                              </label>
                              <label class="toggle">
                                <input type="checkbox" id="toggle-focus-mistakes" />
                                <span>
                                  Fokus på fejl
                                  <span
                                    class="info"
                                    data-tooltip="Bygger runden ud fra dine seneste fejl, hvis der er nogen."
                                    tabindex="0"
                                    aria-label="Info om fokus på fejl"
                                    >i</span
                                  >
                                </span>
                                <small>Gentag sidste fejl</small>
                              </label>
                            </div>
                          </div>
                        </details>

                        <details class="settings-drawer">
                          <summary>
                            <span>Flow &amp; hjælp</span>
                            <small>Tempo, fokus og hjælp</small>
                          </summary>
                          <div class="settings-body">
                            <div class="toggle-grid compact">
                              <label class="toggle">
                                <input type="checkbox" id="toggle-tts" checked />
                                <span>
                                  Læs højt
                                  <span
                                    class="info"
                                    data-tooltip="Aktivér oplæsning og vis indstillinger her i menuen."
                                    tabindex="0"
                                    aria-label="Info om oplæsning"
                                    >i</span
                                  >
                                </span>
                                <small>Oplæsning af spørgsmål</small>
                              </label>
                              <label class="toggle">
                                <input type="checkbox" id="toggle-auto-figure" />
                                <span>
                                  Auto-figurbeskrivelser
                                  <span
                                    class="info"
                                    data-tooltip="Genererer figurbeskrivelser automatisk i baggrunden, så facit matcher billederne."
                                    tabindex="0"
                                    aria-label="Info om figurbeskrivelser"
                                    >i</span
                                  >
                                </span>
                                <small>Batch i baggrunden</small>
                              </label>
                              <label class="toggle">
                                <input type="checkbox" id="toggle-auto-advance" />
                                <span>
                                  Auto-videre
                                  <span
                                    class="info"
                                    data-tooltip="Går automatisk videre efter svar eller spring."
                                    tabindex="0"
                                    aria-label="Info om auto-videre"
                                    >i</span
                                  >
                                </span>
                                <small>Går videre automatisk</small>
                              </label>
                              <label class="toggle">
                                <input type="checkbox" id="toggle-infinite-mode" />
                                <span>
                                  Uendelig mode
                                  <span
                                    class="info"
                                    data-tooltip="Fortsæt med nye spørgsmål, indtil du selv afslutter runden."
                                    tabindex="0"
                                    aria-label="Info om uendelig mode"
                                    >i</span
                                  >
                                </span>
                                <small>Slut når du vil</small>
                              </label>
                              <label class="toggle">
                                <input type="checkbox" id="toggle-focus-mode" />
                                <span>
                                  Fokus-tilstand
                                  <span
                                    class="info"
                                    data-tooltip="Fjerner sidepanelet og giver en roligere spilvisning."
                                    tabindex="0"
                                    aria-label="Info om fokus-tilstand"
                                    >i</span
                                  >
                                </span>
                                <small>Minimal spilvisning</small>
                              </label>
                            </div>

                            <div
                              class="tts-toolbar hidden"
                              id="tts-toolbar"
                              aria-label="Oplæsning"
                              data-collapsed="false"
                            >
                              <div class="tts-header">
                                <div class="tts-title">
                                  <span class="tts-title-text">Oplæsning</span>
                                  <span class="tts-status" id="tts-status" role="status" aria-live="polite">
                                    Oplæsning tjekkes …
                                  </span>
                                </div>
                                <div class="tts-header-actions">
                                  <div class="tts-controls">
                                    <button class="btn ghost small" id="tts-preview-btn" type="button">
                                      Test stemme
                                    </button>
                                  </div>
                                  <button
                                    class="btn ghost small"
                                    id="tts-collapse-btn"
                                    type="button"
                                    aria-expanded="true"
                                  >
                                    Skjul
                                  </button>
                                </div>
                              </div>
                              <div class="tts-body" id="tts-body">
                                <div class="tts-settings">
                                  <label class="tts-toggle">
                                    <input type="checkbox" id="tts-auto-toggle" />
                                    <span>Auto-oplæsning</span>
                                  </label>
                                  <label class="tts-toggle">
                                    <input type="checkbox" id="tts-options-toggle" checked />
                                    <span>Læs svarmuligheder</span>
                                  </label>
                                  <label class="tts-field" for="tts-voice">
                                    <span class="tts-label">Stemme</span>
                                    <select id="tts-voice">
                                      <option value="alloy">Alloy · Klar</option>
                                      <option value="nova">Nova · Varm</option>
                                      <option value="echo">Echo · Tydelig</option>
                                      <option value="fable">Fable · Rolig</option>
                                      <option value="onyx">Onyx · Dyb</option>
                                      <option value="shimmer">Shimmer · Lys</option>
                                    </select>
                                  </label>
                                  <label class="tts-field" for="tts-speed">
                                    <span class="tts-label">Hastighed</span>
                                    <div class="tts-speed">
                                      <input type="range" id="tts-speed" min="0.7" max="1.3" step="0.05" value="1" />
                                      <span id="tts-speed-label">1.0x</span>
                                    </div>
                                  </label>
                                </div>
                              </div>
                            </div>

                            <div class="control-row compact">
                              <label class="control-label" for="auto-advance-delay">
                                Auto-videre tempo
                                <span
                                  class="info"
                                  data-tooltip="Sætter hvor hurtigt auto-videre hopper til næste spørgsmål."
                                  tabindex="0"
                                  aria-label="Info om auto-videre tempo"
                                  >i</span
                                >
                              </label>
                              <div class="range-control">
                                <input
                                  type="range"
                                  id="auto-advance-delay"
                                  min="600"
                                  max="2400"
                                  step="100"
                                  value="1200"
                                />
                                <div class="range-pill" id="auto-advance-label">1.2s</div>
                              </div>
                              <div class="control-hint">Aktiver auto-videre for at bruge tempoet.</div>
                            </div>
                          </div>
                        </details>
                      </div>
                    </details>
                  </div>
                </div>
              </section>

              <section class="panel summary reveal" style="--delay: 0.15s">
                <div class="panel-header">
                  <h2>Din runde</h2>
                  <p>Opsummering af din nuværende opsætning.</p>
                </div>
                <div class="summary-card">
                  <div class="summary-item">Pulje: <strong id="pool-count">0</strong> spørgsmål</div>
                  <div class="summary-item">Runde: <strong id="round-count">0</strong> spørgsmål</div>
                  <div class="summary-item">Mix: <span id="mix-summary">—</span></div>
                  <div class="summary-item">År: <span id="year-summary">—</span></div>
                  <div class="summary-item">Emner: <span id="category-summary">—</span></div>
                  <div class="summary-item">Genbrug: <span id="repeat-summary">—</span></div>
                </div>

                <div class="cta-stack">
                  <button id="start-btn" class="btn primary" type="button">Start spil</button>
                </div>
                <details class="more-drawer">
                  <summary>
                    <span>Mere</span>
                    <small>Hjælp og genveje</small>
                  </summary>
                  <div class="more-body">
                    <button id="rules-btn" class="btn ghost" type="button">Spilguide</button>
                  </div>
                </details>
                <div class="hint" id="selection-hint">Vælg mindst ét emne og ét sæt for at starte.</div>
              </section>
            </div>

            <div class="menu-column">
              <section class="panel filters reveal" style="--delay: 0.1s">
                <div class="panel-header">
                  <h2>Filtrer spørgsmål</h2>
                  <p>Vælg årgang og emner, så runden rammer det du læser op på.</p>
                </div>

                <details class="more-drawer">
                  <summary>
                    <span>Mere</span>
                    <small>Hurtigvalg til filtre</small>
                  </summary>
                  <div class="more-body">
                    <div class="more-actions">
                      <button class="btn ghost small" id="select-all-years" type="button">Alle årgange</button>
                      <button class="btn ghost small" id="clear-years" type="button">Ingen årgange</button>
                      <button class="btn ghost small" id="select-all-categories" type="button">Alle emner</button>
                      <button class="btn ghost small" id="clear-categories" type="button">Ingen emner</button>
                    </div>
                  </div>
                </details>

                <div class="filter-group">
                  <div class="filter-header">
                    <h3>
                      Årgang / sæt
                      <span
                        class="info"
                        data-tooltip="Vælg hvilke eksamensår og sæt der skal indgå i puljen."
                        tabindex="0"
                        aria-label="Info om årgangsfilter"
                        >i</span
                      >
                    </h3>
                  </div>
                  <div class="chip-group" id="year-chips"></div>
                </div>

                <div class="filter-group">
                  <div class="filter-header">
                    <h3>
                      Emner
                      <span
                        class="info"
                        data-tooltip="Vælg præcis hvilke emner der skal trækkes spørgsmål fra."
                        tabindex="0"
                        aria-label="Info om emnefilter"
                        >i</span
                      >
                    </h3>
                    <input type="search" id="category-search" placeholder="Søg emne" />
                  </div>
                  <div class="chip-group" id="category-chips"></div>
                </div>
              </section>

              <section class="panel history-panel reveal" style="--delay: 0.2s">
                <div class="panel-header">
                  <h2>Din udvikling</h2>
                  <p>Se dine seneste runder og om du går frem mod 12.</p>
                </div>
                <div class="history-grid">
                  <div class="history-card">
                    <div class="history-label">Seneste</div>
                    <div class="history-value" id="history-latest">—</div>
                    <div class="history-meta" id="history-latest-meta">Ingen runder endnu</div>
                  </div>
                  <div class="history-card">
                    <div class="history-label">Trend</div>
                    <div class="history-value" id="history-trend">—</div>
                    <div class="history-meta" id="history-trend-meta">Afventer 2 runder</div>
                  </div>
                  <div class="history-card highlight">
                    <div class="history-label">Bedste</div>
                    <div class="history-value" id="history-best">—</div>
                    <div class="history-meta" id="history-best-meta">Mål: 12 (92%)</div>
                  </div>
                </div>
                <div class="history-list" id="history-list"></div>
              </section>
            </div>
          </div>
        </div>
      </section>

      <section id="quiz-screen" class="screen hidden">
        <div class="game-shell">
          <header class="game-header reveal" style="--delay: 0s">
            <div class="game-left">
              <img class="brand-logo small" src="Logo.png" alt="Københavns Universitet logo" />
              <div class="session-pill" id="session-pill">Session</div>
            </div>
            <div class="scoreboard">
              <div class="score">MCQ <span id="mcq-score-value">0</span></div>
              <div class="score">Kortsvar <span id="short-score-value">0</span></div>
              <div class="score">Total <span id="score-value">0%</span></div>
              <div class="best">Bedste <span id="best-score-value">0%</span></div>
            </div>
          </header>

          <div class="game-grid">
            <aside class="game-aside reveal" style="--delay: 0.05s">
              <div class="panel compact">
                <div class="progress-label">
                  <span id="progress-text">0 / 0</span>
                  <span class="tempo" id="tempo-text">Tempo: —</span>
                </div>
                <div class="progress-bar">
                  <div class="progress-fill" id="progress-fill"></div>
                </div>
              </div>

              <details class="panel compact more-panel" id="more-panel">
                <summary>
                  <span>Mere</span>
                  <small>Værktøjer &amp; genveje</small>
                </summary>
                <div class="more-body">
                  <div class="more-actions">
                    <button class="btn ghost small" id="skip-btn" type="button">Spring over (0 point)</button>
                    <button class="btn ghost small" id="back-to-menu" type="button">Til menu</button>
                    <button class="btn ghost small" id="toggle-focus" type="button">Fokus</button>
                    <button class="btn ghost small" id="toggle-meta" type="button">Skjul metadata</button>
                    <button class="btn ghost small hidden" id="end-round-btn" type="button">Afslut runde</button>
                  </div>
                  <div class="shortcut-inline" id="shortcut-inline">
                    <span class="shortcut-label">Taster</span>
                    <span class="shortcut-item is-static">
                      <span class="shortcut-icon" aria-hidden="true">&#x1F524;</span>
                      <span class="shortcut-meta">
                        <span class="shortcut-text">svar</span>
                      </span>
                      <kbd class="keycap">A–D</kbd>
                    </span>
                    <button class="shortcut-item" data-action="next" type="button">
                      <span class="shortcut-icon" aria-hidden="true">&#x23ED;&#xFE0F;</span>
                      <span class="shortcut-meta">
                        <span class="shortcut-text">næste</span>
                        <span class="shortcut-status" aria-live="polite"></span>
                      </span>
                      <kbd class="keycap">N</kbd>
                    </button>
                    <button class="shortcut-item" data-action="skip" type="button">
                      <span class="shortcut-icon" aria-hidden="true">&#x23E9;&#xFE0F;</span>
                      <span class="shortcut-meta">
                        <span class="shortcut-text">spring over</span>
                        <span class="shortcut-status" aria-live="polite"></span>
                      </span>
                      <kbd class="keycap">K</kbd>
                    </button>
                    <button class="shortcut-item" data-action="grade" type="button">
                      <span class="shortcut-icon" aria-hidden="true">&#x1F9EE;</span>
                      <span class="shortcut-meta">
                        <span class="shortcut-text">vurdér</span>
                        <span class="shortcut-status" aria-live="polite"></span>
                      </span>
                      <kbd class="keycap">V</kbd>
                    </button>
                    <button class="shortcut-item" data-action="mic" data-toggle="true" type="button">
                      <span class="shortcut-icon" aria-hidden="true">&#x1F3A4;</span>
                      <span class="shortcut-meta">
                        <span class="shortcut-text">optag</span>
                        <span class="shortcut-status" aria-live="polite"></span>
                      </span>
                      <kbd class="keycap">M</kbd>
                    </button>
                    <button
                      class="shortcut-item"
                      data-action="figure"
                      data-toggle="true"
                      id="shortcut-figure"
                      type="button"
                    >
                      <span class="shortcut-icon" aria-hidden="true">&#x1F5BC;&#xFE0F;</span>
                      <span class="shortcut-meta">
                        <span class="shortcut-text">figur</span>
                        <span class="shortcut-status" aria-live="polite"></span>
                      </span>
                      <kbd class="keycap">G</kbd>
                    </button>
                    <button class="shortcut-item" data-action="hint" data-toggle="true" type="button">
                      <span class="shortcut-icon" aria-hidden="true">&#x1F4A1;</span>
                      <span class="shortcut-meta">
                        <span class="shortcut-text">hint</span>
                        <span class="shortcut-status" aria-live="polite"></span>
                      </span>
                      <kbd class="keycap">H</kbd>
                    </button>
                    <button class="shortcut-item" data-action="tts" data-toggle="true" type="button">
                      <span class="shortcut-icon" aria-hidden="true">&#x1F50A;</span>
                      <span class="shortcut-meta">
                        <span class="shortcut-text">lyd</span>
                        <span class="shortcut-status" aria-live="polite"></span>
                      </span>
                      <kbd class="keycap">L</kbd>
                    </button>
                    <button class="shortcut-item" data-action="focus" data-toggle="true" type="button">
                      <span class="shortcut-icon" aria-hidden="true">&#x1F3AF;</span>
                      <span class="shortcut-meta">
                        <span class="shortcut-text">fokus</span>
                        <span class="shortcut-status" aria-live="polite"></span>
                      </span>
                      <kbd class="keycap">F</kbd>
                    </button>
                    <span class="shortcut-note">Klik på chips eller brug tastaturet.</span>
                  </div>
                </div>
              </details>
            </aside>

            <main class="question-wrap reveal" style="--delay: 0.1s">
              <div class="question-card">
                <div class="question-meta" id="question-meta">
                  <span class="chip soft" id="question-type"></span>
                  <span class="chip soft" id="question-category"></span>
                  <span class="chip" id="question-year"></span>
                  <span class="chip soft" id="question-number"></span>
                </div>
                <p class="question-intro hidden" id="question-intro"></p>
                <div class="question-context hidden" id="question-context">
                  <div class="question-context-title" id="question-context-title"></div>
                  <ul class="question-context-list" id="question-context-list"></ul>
                </div>
                <h2 id="question-text">Spørgsmålet indlæses …</h2>
                <p class="question-subtitle hidden" id="question-subtitle"></p>
                <figure class="question-figure hidden" id="question-figure">
                  <div class="figure-media" id="question-figure-media"></div>
                  <figcaption id="question-figure-caption"></figcaption>
                </figure>
                <div id="options-container" class="options-grid"></div>
                <div id="short-answer-container" class="short-answer hidden">
                  <label class="field-label" for="short-answer-text">Dit svar</label>
                  <div class="short-answer-input" id="short-answer-input-wrap">
                    <textarea
                      id="short-answer-text"
                      rows="6"
                      placeholder="Skriv dit svar her. Brug gerne punktform og nævn nøglebegreber."
                    ></textarea>
                    <div
                      class="transcribe-indicator hidden"
                      id="transcribe-indicator"
                      data-state="transcribing"
                      aria-live="polite"
                    >
                      <span class="transcribe-spinner" aria-hidden="true"></span>
                      <span id="transcribe-text">Transkriberer …</span>
                    </div>
                  </div>
                  <div class="short-sketch-hint hidden" id="short-sketch-hint"></div>
                  <div class="sketch-panel hidden" id="sketch-panel">
                    <div class="sketch-panel-head">
                      <span id="sketch-panel-title">Skitse-analyse (auto)</span>
                    </div>
                    <div class="sketch-panel-body" id="sketch-panel-body">
                      <label class="sketch-upload" id="sketch-dropzone" for="sketch-upload">
                        <input type="file" id="sketch-upload" accept="image/*" />
                        <span class="sketch-upload-text">Vælg billede af din skitse</span>
                        <span class="sketch-drop-hint">Træk &amp; slip her</span>
                      </label>
                      <img class="sketch-preview hidden" id="sketch-preview" alt="Forhåndsvisning af skitse" />
                      <div class="sketch-actions">
                        <span class="sketch-status" id="sketch-status"></span>
                        <button class="btn ghost small hidden" id="sketch-retry-btn" type="button">
                          Prøv igen
                        </button>
                      </div>
                      <div class="sketch-feedback" id="sketch-feedback"></div>
                    </div>
                  </div>
                  <div class="review-drawer" id="short-review-drawer" data-open="false">
                    <div class="short-toolbar">
                      <div class="score-control">
                        <div class="score-label">
                          Point <span class="score-max">/ <span id="short-max-points">0</span></span>
                        </div>
                        <div class="score-inputs">
                          <input type="range" id="short-score-range" min="0" max="10" step="0.5" value="0" />
                          <input type="number" id="short-score-input" min="0" max="10" step="0.5" value="0" />
                        </div>
                        <div class="score-hint" id="short-score-hint"></div>
                      </div>
                      <div class="short-buttons">
                        <button class="btn ghost small" id="short-show-answer-btn" type="button">
                          Vis facit
                        </button>
                      </div>
                    </div>
                    <div class="ai-status" id="ai-status-inline"></div>
                    <div class="short-ai-feedback" id="short-ai-feedback"></div>
                    <div class="short-ai-actions">
                      <button class="btn ghost small hidden" id="short-ai-retry-btn" type="button">
                        Prøv igen
                      </button>
                    </div>
                    <div class="short-model hidden" id="short-model-answer">
                      <div class="short-model-head">
                        <h4 id="short-model-title">Modelbesvarelse</h4>
                        <span class="short-model-tag hidden" id="short-model-tag">Figurbeskrivelse</span>
                      </div>
                      <p id="short-model-text"></p>
                      <div class="short-figure hidden" id="short-figure-answer">
                        <div class="short-figure-head">
                          <h5>Figurbeskrivelse</h5>
                          <button class="btn ghost small" id="short-figure-generate-btn" type="button">Generér</button>
                        </div>
                        <div class="short-figure-status" id="short-figure-status"></div>
                        <p id="short-figure-text"></p>
                      </div>
                      <div class="short-sources" id="short-sources"></div>
                    </div>
                  </div>
                </div>
                <div class="question-hint hidden" id="question-hint">
                  <div class="question-hint-head">
                    <span>Hint</span>
                    <span class="question-hint-status" id="question-hint-status"></span>
                  </div>
                  <div class="question-hint-text hidden" id="question-hint-text"></div>
                </div>
                <div class="actions">
                  <button
                    class="btn ghost mic-btn hidden"
                    id="mic-btn"
                    type="button"
                    aria-label="Optag svar (M)"
                    title="Optag svar (M)"
                  >
                    <span class="mic-icon" aria-hidden="true">&#x1F3A4;</span>
                  </button>
                  <button class="btn secondary" id="next-btn" type="button" disabled>Næste</button>
                </div>
                <div class="feedback" id="feedback-area"></div>
              </div>
            </main>
          </div>
        </div>
      </section>

      <section id="result-screen" class="screen hidden">
        <div class="result-shell reveal" style="--delay: 0s">
          <div class="result-header">
            <div>
              <div class="eyebrow">Resultat</div>
              <h2>Din score <span id="final-score">0%</span></h2>
              <div class="result-metrics">
                <div class="grade-pill">Karakter <span id="final-grade">-</span></div>
                <div class="grade-pill">Samlet <span id="final-percent">0%</span></div>
              </div>
              <p id="final-message"></p>
            </div>
            <div class="result-badge">
              <img class="brand-logo small" src="Logo.png" alt="Københavns Universitet logo" />
              <div class="pill highlight" id="best-badge">Ny personlig rekord!</div>
            </div>
          </div>

          <div class="result-breakdown">
            <div class="result-card">
              <div class="label">MCQ-point</div>
              <div class="value" id="result-mcq-points">0</div>
              <div class="meta" id="result-mcq-percent">0%</div>
            </div>
            <div class="result-card">
              <div class="label">Kortsvar point</div>
              <div class="value" id="result-short-points">0</div>
              <div class="meta" id="result-short-percent">0%</div>
            </div>
            <div class="result-card highlight">
              <div class="label">Karakter</div>
              <div class="value" id="result-grade">-</div>
              <div class="meta">7-trinsskala</div>
            </div>
          </div>

          <div class="stat-grid">
            <div class="stat">
              <div class="label">Korrekte</div>
              <div class="value" id="stat-correct">0</div>
            </div>
            <div class="stat">
              <div class="label">Forkerte</div>
              <div class="value" id="stat-wrong">0</div>
            </div>
            <div class="stat">
              <div class="label">Sprunget over</div>
              <div class="value" id="stat-skipped">0</div>
            </div>
            <div class="stat">
              <div class="label">Kortsvar point</div>
              <div class="value" id="stat-short-score">0 / 72</div>
            </div>
            <div class="stat">
              <div class="label">Tempo</div>
              <div class="value" id="stat-pace">—</div>
            </div>
          </div>

          <div class="actions result-actions">
            <button class="btn primary" id="play-again-btn" type="button">Spil igen</button>
          </div>
          <details class="more-drawer">
            <summary>
              <span>Mere</span>
              <small>Session og navigation</small>
            </summary>
            <div class="more-body">
              <button class="btn ghost" id="restart-round-btn" type="button">Start igen</button>
              <button class="btn ghost" id="return-menu-btn" type="button">Til menu</button>
            </div>
          </details>

          <div class="review-queue hidden" id="review-queue">
            <div class="review-queue-header">
              <div>
                <h3>Smart review</h3>
                <p>Gennemgå kortsvar du missede med hurtige hints.</p>
              </div>
              <div class="review-queue-status" id="review-queue-status"></div>
            </div>
            <div id="review-queue-list" class="review-queue-list"></div>
          </div>

          <div class="review">
            <div class="review-header">
              <h3>Din runde</h3>
            </div>
            <details class="more-drawer review-filter-drawer">
              <summary>
                <span>Filtre</span>
                <small>Vis rigtige, forkerte og sprunget over</small>
              </summary>
              <div class="more-body">
                <div class="review-filters" role="group" aria-label="Filtrer din runde">
                  <button class="review-filter" id="review-filter-correct" type="button" aria-pressed="false">
                    Rigtige
                  </button>
                  <button class="review-filter" id="review-filter-wrong" type="button" aria-pressed="true">
                    Forkerte
                  </button>
                  <button class="review-filter" id="review-filter-skipped" type="button" aria-pressed="true">
                    Sprunget over
                  </button>
                </div>
              </div>
            </details>
            <div id="review-list" class="review-list"></div>
          </div>
        </div>
      </section>
    </div>

    <div class="modal hidden" id="rules-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Spilguide</h3>
          <button class="icon-btn" id="close-modal" type="button">Luk</button>
        </div>
        <div class="modal-grid">
          <div>
            <h4>Point &amp; flow</h4>
            <ul class="rules-list">
              <li>+3 point for korrekt, -1 for forkert, 0 for at springe over.</li>
              <li>Kortsvar bedømmes på 0–max point pr. delspørgsmål (med eller uden hjælp).</li>
              <li>Samlet score og 7-trin karakter beregnes 50/50 mellem MCQ og kortsvar.</li>
              <li>Kortsvar under 5 point tæller som fejlet.</li>
              <li>Figurer er skjult – brug “Vis figur” når du har brug for dem.</li>
              <li>Du kan skræddersy runden med emner, årgange og mixer.</li>
              <li>Uendelig mode fortsætter, indtil du afslutter runden.</li>
              <li>Spillet gemmer din bedste score og dine seneste fejl lokalt.</li>
            </ul>
          </div>
          <div>
            <h4>Shortcuts</h4>
            <ul class="rules-list">
              <li>
                <span class="shortcut-icon" aria-hidden="true">&#x1F524;</span>
                <kbd class="keycap">A–D</kbd> svar på spørgsmål
              </li>
              <li>
                <span class="shortcut-icon" aria-hidden="true">&#x23ED;&#xFE0F;</span>
                <kbd class="keycap">N</kbd> gå videre når svar er givet
              </li>
              <li>
                <span class="shortcut-icon" aria-hidden="true">&#x23E9;&#xFE0F;</span>
                <kbd class="keycap">K</kbd> spring over
              </li>
              <li>
                <span class="shortcut-icon" aria-hidden="true">&#x1F9EE;</span>
                <kbd class="keycap">V</kbd> vurdér (auto-bedøm)
              </li>
              <li>
                <span class="shortcut-icon" aria-hidden="true">&#x1F3A4;</span>
                <kbd class="keycap">M</kbd> optag svar
              </li>
              <li>
                <span class="shortcut-icon" aria-hidden="true">&#x1F5BC;&#xFE0F;</span>
                <kbd class="keycap">G</kbd> vis/skjul figur
              </li>
              <li>
                <span class="shortcut-icon" aria-hidden="true">&#x1F4A1;</span>
                <kbd class="keycap">H</kbd> hint
              </li>
              <li>
                <span class="shortcut-icon" aria-hidden="true">&#x1F50A;</span>
                <kbd class="keycap">L</kbd> oplæsning
              </li>
              <li>
                <span class="shortcut-icon" aria-hidden="true">&#x1F3AF;</span>
                <kbd class="keycap">F</kbd> fokus
              </li>
            </ul>
          </div>
        </div>
        <div class="modal-actions">
          <button class="btn ghost" id="modal-close-btn" type="button">Tilbage</button>
        </div>
      </div>
    </div>

    <div class="modal hidden figure-modal" id="figure-modal">
      <div class="modal-content figure-modal-content">
        <div class="modal-header">
          <h3 id="figure-modal-title">Figur</h3>
          <button class="icon-btn" id="figure-modal-close" type="button">Luk</button>
        </div>
        <div class="figure-modal-body">
          <img id="figure-modal-img" alt="" />
          <div class="figure-modal-caption" id="figure-modal-caption"></div>
        </div>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
